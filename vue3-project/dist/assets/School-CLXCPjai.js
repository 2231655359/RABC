import{u as M}from"./school-DtmllmaV.js";import{d as N,r as u,a as q,i as L,o as P,c as R,g as C,b as o,w as a,k as j,q as A,f as s,h as p,B as I,E as W}from"./index-DkugqgKa.js";const G={style:{margin:"20px 0"}},H={class:"dialog-footer"},Q=N({__name:"School",setup(J){let i=M(),_=u([]);const r=()=>{i.getSchoolList({page:c.value,size:v.value}).then(l=>{_.value=i.schools,h.value=l==null?void 0:l.total})},c=u(1),v=u(5),h=u(0),x=l=>{v.value=l,r()},y=l=>{c.value=l,r()},S=l=>{b(),i.getSchoolById(l).then(e=>{n.value=e})},k=l=>{I.confirm("确定要删除此条数据吗?","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{i.deleteSchool(l).then(()=>{W({type:"success",message:"删除成功"}),r()})}).catch(()=>{})},b=()=>{d.value=!0,n.value={_id:null,schoolname:""},A(()=>{var l;(l=g.value)==null||l.resetFields()})},d=u(!1),g=u(),w=q({schoolname:[{required:!0,message:"请输入学校名称",trigger:"blur"}]}),n=u({_id:null,schoolname:""}),z=l=>{l&&l.validate(e=>{e?i.addSchool(n.value).then(()=>{d.value=!1,r()}):console.log("error submit!")})},V=l=>{l&&l.validate(e=>{e?i.updateSchool(n.value).then(()=>{d.value=!1,r()}):console.log("error submit!")})};return L(()=>{r()}),(l,e)=>{const m=s("el-button"),f=s("el-table-column"),B=s("el-table"),F=s("el-pagination"),T=s("el-input"),U=s("el-form-item"),$=s("el-form"),D=s("el-dialog");return P(),R("div",null,[C("div",G,[o(m,{type:"primary",onClick:b},{default:a(()=>e[6]||(e[6]=[p("添加学校")])),_:1})]),o(B,{data:j(_),style:{width:"100%",height:"380px"}},{default:a(()=>[o(f,{label:"序号",type:"index",width:"80"}),o(f,{label:"学校名称",prop:"schoolname"}),o(f,{label:"操作",width:"200"},{default:a(t=>[o(m,{size:"small",onClick:E=>S(t.row._id)},{default:a(()=>e[7]||(e[7]=[p(" 编辑 ")])),_:2},1032,["onClick"]),o(m,{size:"small",type:"danger",onClick:E=>k(t.row._id)},{default:a(()=>e[8]||(e[8]=[p(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),o(F,{"current-page":c.value,"onUpdate:currentPage":e[0]||(e[0]=t=>c.value=t),"page-size":v.value,"onUpdate:pageSize":e[1]||(e[1]=t=>v.value=t),"page-sizes":[5,10,15,20],layout:"total, sizes, prev, pager, next, jumper",total:h.value,onSizeChange:x,onCurrentChange:y},null,8,["current-page","page-size","total"]),o(D,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=t=>d.value=t),title:"添加/编辑学校",width:"500"},{footer:a(()=>[C("div",H,[o(m,{type:"primary",onClick:e[3]||(e[3]=t=>n.value._id==null?z(g.value):V(g.value))},{default:a(()=>e[9]||(e[9]=[p(" 确定 ")])),_:1}),o(m,{onClick:e[4]||(e[4]=t=>d.value=!1)},{default:a(()=>e[10]||(e[10]=[p("取消")])),_:1})])]),default:a(()=>[o($,{model:n.value,"label-width":"100px",style:{width:"400px"},ref_key:"schoolFormRef",ref:g,rules:w},{default:a(()=>[o(U,{label:"学校名称",prop:"schoolname"},{default:a(()=>[o(T,{modelValue:n.value.schoolname,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.schoolname=t),placeholder:"请输入学校名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{Q as default};
