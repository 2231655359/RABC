import{u as D}from"./major-DGD-pr_j.js";import{d as E,r as s,a as N,i as q,o as L,c as P,g as C,b as a,w as o,k as R,q as A,f as r,h as p,B as I,E as W}from"./index-DkugqgKa.js";const G={style:{margin:"20px 0"}},H={class:"dialog-footer"},Q=E({__name:"Major",setup(J){let u=D(),c=s([]);const i=()=>{u.getMajorList({page:v.value,size:g.value}).then(t=>{c.value=u.majors,j.value=t==null?void 0:t.total})},v=s(1),g=s(5),j=s(0),x=t=>{g.value=t,i()},y=t=>{v.value=t,i()},k=t=>{b(),u.getMajorById(t).then(e=>{n.value=e})},w=t=>{I.confirm("确定要删除此条数据吗?","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{u.deleteMajor(t).then(()=>{W({type:"success",message:"删除成功"}),i()})}).catch(()=>{})},b=()=>{d.value=!0,n.value={_id:null,majorname:""},A(()=>{var t;(t=f.value)==null||t.resetFields()})},d=s(!1),f=s(),z=N({majorname:[{required:!0,message:"请输入专业名称",trigger:"blur"}]}),n=s({_id:null,majorname:""}),M=t=>{t&&t.validate(e=>{e?u.addMajor(n.value).then(()=>{d.value=!1,i()}):console.log("error submit!")})},V=t=>{t&&t.validate(e=>{e?u.updateMajor(n.value).then(()=>{d.value=!1,i()}):console.log("error submit!")})};return q(()=>{i()}),(t,e)=>{const m=r("el-button"),_=r("el-table-column"),h=r("el-table"),B=r("el-pagination"),S=r("el-input"),F=r("el-form-item"),T=r("el-form"),U=r("el-dialog");return L(),P("div",null,[C("div",G,[a(m,{type:"primary",onClick:b},{default:o(()=>e[6]||(e[6]=[p("添加专业")])),_:1})]),a(h,{data:R(c),style:{width:"100%",height:"380px"}},{default:o(()=>[a(_,{label:"序号",type:"index",width:"80"}),a(_,{label:"专业名称",prop:"majorname"}),a(_,{label:"操作",width:"200"},{default:o(l=>[a(m,{size:"small",onClick:$=>k(l.row._id)},{default:o(()=>e[7]||(e[7]=[p(" 编辑 ")])),_:2},1032,["onClick"]),a(m,{size:"small",type:"danger",onClick:$=>w(l.row._id)},{default:o(()=>e[8]||(e[8]=[p(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(B,{"current-page":v.value,"onUpdate:currentPage":e[0]||(e[0]=l=>v.value=l),"page-size":g.value,"onUpdate:pageSize":e[1]||(e[1]=l=>g.value=l),"page-sizes":[5,10,15,20],layout:"total, sizes, prev, pager, next, jumper",total:j.value,onSizeChange:x,onCurrentChange:y},null,8,["current-page","page-size","total"]),a(U,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=l=>d.value=l),title:"添加/编辑专业",width:"500"},{footer:o(()=>[C("div",H,[a(m,{type:"primary",onClick:e[3]||(e[3]=l=>n.value._id==null?M(f.value):V(f.value))},{default:o(()=>e[9]||(e[9]=[p(" 确定 ")])),_:1}),a(m,{onClick:e[4]||(e[4]=l=>d.value=!1)},{default:o(()=>e[10]||(e[10]=[p("取消")])),_:1})])]),default:o(()=>[a(T,{model:n.value,"label-width":"100px",style:{width:"400px"},ref_key:"majorFormRef",ref:f,rules:z},{default:o(()=>[a(F,{label:"专业名称",prop:"majorname"},{default:o(()=>[a(S,{modelValue:n.value.majorname,"onUpdate:modelValue":e[2]||(e[2]=l=>n.value.majorname=l),placeholder:"请输入专业名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{Q as default};
