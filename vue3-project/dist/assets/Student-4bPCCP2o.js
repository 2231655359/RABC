import{u as me}from"./student-CDUywyxc.js";import{u as _e}from"./class-CBCYlJYE.js";import{u as ce}from"./role-7JurnY40.js";import{d as ve,u as ge,r as u,i as fe,o as m,c as f,b as t,w as n,e as we,f as v,F as x,s as C,k as d,h as i,g as r,t as o,B as he,E as be,v as S}from"./index-DkugqgKa.js";import"./index-Bug_QlJt.js";const ye={style:{padding:"20px"}},xe=["innerHTML"],Ue=ve({__name:"Student",setup(Ce){const G="/pro-api";let M=me(),V=_e(),k=ce(),z=ge(),E=u([]),R=u([]),A=u(""),D=u(""),O=u([]),U=u([]),N=u([{_id:"0",name:"男"},{_id:"1",name:"女"}]),K=u([{_id:"1",name:"大一"},{_id:"2",name:"大二"},{_id:"3",name:"大三"},{_id:"4",name:"大四"},{_id:"5",name:"在读研究生"}]),W=u([{_id:"1",name:"专科"},{_id:"2",name:"本科"},{_id:"3",name:"硕士"},{_id:"4",name:"社会"}]),T=u([{_id:"1",name:"web前端"},{_id:"2",name:"Java"},{_id:"3",name:"C/C++"},{_id:"4",name:"少儿编程"},{_id:"5",name:"直播电商"}]);const w=u([]),X=()=>{var a;(a=V.classes)!=null&&a.length?w.value=V.classes:V.getClassAll().then(()=>{w.value=V.classes})},_=(a,l)=>{let g=l==null?void 0:l.find(c=>c._id==a);return g?g.name:""},q=(a,l)=>{let g=l==null?void 0:l.find(c=>c._id==a);return g?g.classname:""},Y=()=>{var a;(a=k.roles)!=null&&a.length?(R.value=k.roles,H()):k.roleList().then(()=>{R.value=k.roles,H()})},H=()=>{R.value.forEach(a=>{a.name=="教师"?A.value=a._id:a.name=="学管"&&(D.value=a._id)})},Z=()=>{z.users.length?(E.value=z.users,P()):z.getUserAll().then(()=>{E.value=z.users,P()})},P=()=>{E.value.forEach(a=>{a.role_id==A.value?O.value.push(a):a.role_id==D.value&&U.value.push(a)})},$=u([]),s=u({name:"",direction:"",class:"",teacher_id:"",manager_id:""}),Q=u(0),h=u(1),L=u(10),ee=a=>{L.value=a,b()},le=a=>{h.value=a,b()},b=()=>{M.getStudentList({page:h.value,size:L.value,searchMap:s.value}).then(a=>{$.value=M.students,Q.value=a==null?void 0:a.total,console.log($.value)})},I=u(),ae=()=>{h.value=1,b()},J=we(),te=()=>{J.push("/student/update/-1")},ne=a=>{a&&a.resetFields()},oe=a=>{J.push(`/student/update/${a}`)},re=a=>{he.confirm("确定要删除此条数据吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{M.deleteStudent(a).then(()=>{be({type:"success",message:"删除成功"}),b()})}).catch(()=>{})};return fe(()=>{Y(),Z(),X(),b()}),(a,l)=>{const g=v("el-input"),c=v("el-form-item"),B=v("el-option"),F=v("el-select"),y=v("el-button"),ue=v("el-form"),de=v("el-image"),p=v("el-table-column"),se=v("el-table"),ie=v("el-pagination");return m(),f("div",null,[t(ue,{inline:!0,model:s.value,style:{margin:"20px 0"},ref_key:"searchFormRef",ref:I},{default:n(()=>[t(c,{prop:"name"},{default:n(()=>[t(g,{modelValue:s.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value.name=e),placeholder:"根据姓名查询",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{prop:"direction",style:{width:"200px"}},{default:n(()=>[t(F,{modelValue:s.value.direction,"onUpdate:modelValue":l[1]||(l[1]=e=>s.value.direction=e),placeholder:"根据学习方向查询",clearable:""},{default:n(()=>[(m(!0),f(x,null,C(d(T),e=>(m(),S(B,{label:e.name,value:e._id,key:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{prop:"class",style:{width:"200px"}},{default:n(()=>[t(F,{modelValue:s.value.class,"onUpdate:modelValue":l[2]||(l[2]=e=>s.value.class=e),placeholder:"根据班级查询",clearable:""},{default:n(()=>[(m(!0),f(x,null,C(w.value,e=>(m(),S(B,{label:e.classname,value:e._id,key:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{prop:"teacher_id",style:{width:"200px"}},{default:n(()=>[t(F,{modelValue:s.value.teacher_id,"onUpdate:modelValue":l[3]||(l[3]=e=>s.value.teacher_id=e),placeholder:"根据授课教师查询",clearable:""},{default:n(()=>[(m(!0),f(x,null,C(d(O),e=>(m(),S(B,{label:e.name,value:e._id,key:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{prop:"manager_id",style:{width:"200px"}},{default:n(()=>[t(F,{modelValue:s.value.manager_id,"onUpdate:modelValue":l[4]||(l[4]=e=>s.value.manager_id=e),placeholder:"根据学管查询",clearable:""},{default:n(()=>[(m(!0),f(x,null,C(d(U),e=>(m(),S(B,{label:e.name,value:e._id,key:e._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:n(()=>[t(y,{type:"primary",onClick:ae},{default:n(()=>l[8]||(l[8]=[i("查询")])),_:1}),t(y,{type:"primary",onClick:te},{default:n(()=>l[9]||(l[9]=[i("添加学员")])),_:1}),t(y,{onClick:l[5]||(l[5]=e=>ne(I.value))},{default:n(()=>l[10]||(l[10]=[i("重置")])),_:1})]),_:1})]),_:1},8,["model"]),t(se,{data:$.value,style:{width:"100%",height:"450px"}},{default:n(()=>[t(p,{type:"expand"},{default:n(e=>[r("div",ye,[r("p",null,"学生姓名: "+o(e.row.name),1),r("p",null," 性别: "+o(_(e.row.gender,d(N))),1),r("p",null,"所在学校: "+o(e.row.school),1),r("p",null,"专业: "+o(e.row.major),1),r("p",null," 年级: "+o(_(e.row.grade,d(K))),1),r("p",null," 学历: "+o(_(e.row.education,d(W))),1),r("p",null," 学习方向: "+o(_(e.row.direction,d(T))),1),r("p",null,"身份号码: "+o(e.row.id_number),1),r("p",null,"电话号码: "+o(e.row.phone),1),r("p",null,"家长姓名: "+o(e.row.parent),1),r("p",null,"家长联系电话: "+o(e.row.parent_phone),1),r("p",null,"家庭住址: "+o(e.row.address),1),r("p",null,"QQ号码: "+o(e.row.qq),1),r("p",null," 所在班级: "+o(q(e.row.class,w.value)),1),r("p",null,"入学时间: "+o(e.row.admission_date),1),r("p",null," 授课教师: "+o(_(e.row.teacher_id,d(O))),1),r("p",null," 学管: "+o(_(e.row.manager_id,d(U))),1),r("p",null,[l[11]||(l[11]=i(" 照片: ")),(m(!0),f(x,null,C(e.row.pictures,(j,pe)=>(m(),S(de,{style:{width:"200px",height:"200px","margin-right":"5px"},src:d(G)+"/upload/"+j,key:pe,fit:"cover"},null,8,["src"]))),128))]),r("p",null,[l[12]||(l[12]=i("备注信息: ")),r("span",{innerHTML:e.row.note},null,8,xe)])])]),_:1}),t(p,{label:"序号",type:"index",width:"80px"}),t(p,{label:"学生姓名",prop:"name",width:"100px"}),t(p,{label:"性别",prop:"gender",width:"100px"},{default:n(e=>[i(o(_(e.row.gender,d(N))),1)]),_:1}),t(p,{label:"学习方向",prop:"direction"},{default:n(e=>[i(o(_(e.row.direction,d(T))),1)]),_:1}),t(p,{label:"电话号码",prop:"phone"}),t(p,{label:"所在班级",prop:"class"},{default:n(e=>[i(o(q(e.row.class,w.value)),1)]),_:1}),t(p,{label:"授课教师",prop:"teacher_id"},{default:n(e=>[i(o(_(e.row.teacher_id,d(O))),1)]),_:1}),t(p,{label:"学管",prop:"manager_id"},{default:n(e=>[i(o(_(e.row.manager_id,d(U))),1)]),_:1}),t(p,{label:"入学时间",prop:"admission_date"}),t(p,{label:"操作"},{default:n(e=>[t(y,{size:"small",onClick:j=>oe(e.row._id)},{default:n(()=>l[13]||(l[13]=[i(" 编辑 ")])),_:2},1032,["onClick"]),t(y,{size:"small",type:"danger",onClick:j=>re(e.row._id)},{default:n(()=>l[14]||(l[14]=[i(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(ie,{"current-page":h.value,"onUpdate:currentPage":l[6]||(l[6]=e=>h.value=e),"page-size":L.value,"onUpdate:pageSize":l[7]||(l[7]=e=>L.value=e),"page-sizes":[10,20,30,40],layout:"total, sizes, prev, pager, next, jumper",total:Q.value,onSizeChange:ee,onCurrentChange:le},null,8,["current-page","page-size","total"])])}}});export{Ue as default};
